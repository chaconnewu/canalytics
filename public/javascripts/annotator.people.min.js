/*
** Annotator 1.2.5-dev-b83d51d
** https://github.com/okfn/annotator/
**
** Copyright 2012 Aron Carroll, Rufus Pollock, and Nick Stenning.
** Dual licensed under the MIT and GPLv3 licenses.
** https://github.com/okfn/annotator/blob/master/LICENSE
**
** Built at: 2013-02-08 18:57:16Z
*/(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Annotator.Plugin.People=function(t){function r(){return this.setAnnotationRelationship=e(this.setAnnotationRelationship,this),this.setAnnotationPeople=e(this.setAnnotationPeople,this),this.updateField2=e(this.updateField2,this),this.updateField1=e(this.updateField1,this),r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.options={parsePeople:function(e){var t;return e=$.trim(e),t=[],e&&(t=e.split(",")),t},stringifyPeople:function(e){return e.join(" ")}},r.prototype.field=null,r.prototype.input=null,r.prototype.pluginInit=function(){if(!Annotator.supported())return;return this.field1=this.annotator.editor.addField({type:"select1",label:Annotator._t("Attendees"),load:this.updateField1,submit:this.setAnnotationPeople}),this.field2=this.annotator.editor.addField({type:"select2",label:Annotator._t("Relationship"),load:this.updateField2,submit:this.setAnnotationRelationship}),this.annotator.viewer.addField({load:this.updateViewer}),this.input1=$(this.field1).find("select"),this.input2=$(this.field2).find("select"),this.annotator.subscribe("annotationEditorShown",this.loadGraph),this.annotator.subscribe("annotationEditorSubmit",this.updateGraph)},r.prototype.parsePeople=function(e){return this.options.parsePeople(e)},r.prototype.stringifyPeople=function(e){return this.options.stringifyPeople(e)},r.prototype.loadGraph=function(e,t){return t.oldpeople=t.people?t.people:[],t.oldrelationship=t.relationship?t.relationship:[]},r.prototype.updateGraph=function(e,t){},r.prototype.updateField1=function(e,t){var n;return n="",t.people&&(n=this.stringifyPeople(t.people)),this.input1.val(n)},r.prototype.updateField2=function(e,t){var n;return n="",t.relationship&&(n=this.stringifyPeople(t.relationship)),this.input2.val(n)},r.prototype.setAnnotationPeople=function(e,t){return t.people=this.parsePeople(this.input1.val())},r.prototype.setAnnotationRelationship=function(e,t){return t.relationship=this.parsePeople(this.input2.val())},r.prototype.updateViewer=function(e,t){return e=$(e),t.people&&$.isArray(t.people)&&t.people.length?e.addClass("annotator-people").html(function(){var e;return e=$.map(t.people,function(e){return'<span class="annotator-person">'+Annotator.$.escape(e)+"</span>"}).join(" "),e=e+" are in a relationship "+t.relationship}):e.remove()},r}(Annotator.Plugin)}).call(this);